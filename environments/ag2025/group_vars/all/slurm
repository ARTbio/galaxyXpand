---
# ansible-slurm
slurm_roles: ['controller', 'exec']
slurm_user: galaxy

slurm_config:
  ControlMachine: "{{ ansible_hostname }}"
  AccountingStorageType: accounting_storage/none
  SlurmUser: slurm
  SlurmctldLogFile: /var/log/slurm/slurmctld.log
  SlurmdLogFile: /var/log/slurm/slurmd.log
  SlurmdSpoolDir: /tmp/slurmd
  StateSaveLocation: /tmp/slurm
  SelectType: select/cons_tres
  SelectTypeParameters: CR_Core_Memory
  AuthType: auth/munge
  CryptoType: crypto/munge
  CommunicationParameters: DisableIPv6
  MailProg: /bin/true
  MpiDefault: none

slurm_nodes:
  - name: "{{ ansible_hostname }}"
    CPUs: "{{ ansible_processor_vcpus }}"
    RealMemory: "{{ (ansible_memtotal_mb | int * 0.95) | round(0, 'floor') | int }}"
    State: UNKNOWN

slurm_partitions:
  - name: debug
    Default: YES
    Nodes: "{{ ansible_hostname }}"
    State: UP
    DefMemPerCPU: "{{ ((ansible_memtotal_mb | int) * 0.9 / (ansible_processor_vcpus | int)) | round(0, 'floor') | int }}"
