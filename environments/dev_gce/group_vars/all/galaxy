---
# optimize 2 cpu VM GCE

# development branch
galaxy_commit_id: release_24.1

galaxy_config:
  gravity:
    gunicorn:
      bind: "0.0.0.0:4000"
      workers: 2
    handlers:
      job_handlers:
        pools:
          - job-handlers
        processes: 2      # optimisation test
    celery:
      workers: 1          # un seul worker Celery si utilis√©
  
  galaxy:
    admin_users: admin@example.org,tooladmin@galaxy.org
    database_connection: postgresql:///galaxy?host=/var/run/postgresql
    # job_config_file is now ignored for getting default (job_conf.yml)
    job_working_directory: /home/galaxy/galaxy/database/jobs
    file_path: datasets
    enable_per_request_sql_debugging: false
    enable_quotas: false
    static_enabled: false
    allow_user_dataset_purge: true
    allow_user_deletion: true
    allow_user_impersonation: true
    cleanup_job: onsuccess
    expose_dataset_path: true
    expose_potentially_sensitive_job_metrics: true
    job_handler_monitor_sleep: 0.05 # test de performance
    # don't let galaxyproject.galaxy role injecting this variable, unless bug
    themes_config_file_by_host: {}  # GitHub CI fix

# deploy galaxy static files

galaxy_config_templates:
  - src: "{{ inventory_dir }}/templates/galaxyXpand_welcome.html.j2"
    dest: "{{ galaxy_server_dir }}/static/galaxy_welcome.html"

# deploy galaxyXpand logo and job_conf.yml
galaxy_config_files:
  - src: "{{ inventory_dir }}/files/job_conf.yml"
    dest: "{{ galaxy_config_dir }}/job_conf.yml"
  - src: "{{ inventory_dir }}/files/galaxyXpand_logo.png"
    dest: "{{ galaxy_server_dir }}/static/images/galaxyXpand_logo.png" 

